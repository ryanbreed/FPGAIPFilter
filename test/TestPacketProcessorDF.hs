{-# LANGUAGE TemplateHaskell #-}
{-# LANGUAGE DataKinds #-}
{-# LANGUAGE NoImplicitPrelude #-}

import Protolude
import CLaSH.Prelude hiding (drop, print)
import PacketProcessorDF

testInput :: Signal (MemOp, Bool)
testInput = stimuliGenerator $(listToVecTH
  [ (SETP 9 0xF0 0x10, True)
  , (WRITE 0x45, True)
  , (WRITE 0x00, True)
  , (WRITE 0x00, True)
  , (WRITE 0x70, True)
  , (WRITE 0x00, True)
  , (WRITE 0x00, True)
  , (WRITE 0x40, True)
  , (WRITE 0x00, True)
  , (WRITE 0x40, True)
  , (WRITE 0x11, True)
  , (WRITE 0x24, True)
  , (WRITE 0x3b, True)
  , (WRITE 0x0a, True)
  , (WRITE 0x01, True)
  , (WRITE 0x01, True)
  , (WRITE 0x0a, True)
  , (WRITE 0x0a, True)
  , (WRITE 0x01, True)
  , (WRITE 0x01, True)
  , (WRITE 0x37, True)
  , (WRITE 0x00, True)
  , (WRITE 0x35, True)
  , (WRITE 0x3e, True)
  , (WRITE 0x1a, True)
  , (WRITE 0x00, True)
  , (WRITE 0x5c, True)
  , (WRITE 0x65, True)
  , (WRITE 0xaa, True)
  , (WRITE 0x07, True)
  , (WRITE 0xec, True)
  , (WRITE 0x81, True)
  , (WRITE 0x80, True)
  , (WRITE 0x00, True)
  , (WRITE 0x01, True)
  , (WRITE 0x00, True)
  , (WRITE 0x01, True)
  , (WRITE 0x00, True)
  , (WRITE 0x00, True)
  , (WRITE 0x00, True)
  , (WRITE 0x00, True)
  , (WRITE 0x02, True)
  , (WRITE 0x32, True)
  , (WRITE 0x35, True)
  , (WRITE 0x03, True)
  , (WRITE 0x31, True)
  , (WRITE 0x35, True)
  , (WRITE 0x36, True)
  , (WRITE 0x03, True)
  , (WRITE 0x31, True)
  , (WRITE 0x37, True)
  , (WRITE 0x36, True)
  , (WRITE 0x03, True)
  , (WRITE 0x32, True)
  , (WRITE 0x31, True)
  , (WRITE 0x30, True)
  , (WRITE 0x07, True)
  , (WRITE 0x69, True)
  , (WRITE 0x6e, True)
  , (WRITE 0x2d, True)
  , (WRITE 0x61, True)
  , (WRITE 0x64, True)
  , (WRITE 0x64, True)
  , (WRITE 0x72, True)
  , (WRITE 0x04, True)
  , (WRITE 0x61, True)
  , (WRITE 0x72, True)
  , (WRITE 0x70, True)
  , (WRITE 0x61, True)
  , (WRITE 0x00, True)
  , (WRITE 0x00, True)
  , (WRITE 0x0c, True)
  , (WRITE 0x00, True)
  , (WRITE 0x01, True)
  , (WRITE 0xc0, True)
  , (WRITE 0x0c, True)
  , (WRITE 0x00, True)
  , (WRITE 0x0c, True)
  , (WRITE 0x00, True)
  , (WRITE 0x01, True)
  , (WRITE 0x00, True)
  , (WRITE 0x00, True)
  , (WRITE 0x89, True)
  , (WRITE 0x40, True)
  , (WRITE 0x00, True)
  , (WRITE 0x1b, True)
  , (WRITE 0x07, True)
  , (WRITE 0x75, True)
  , (WRITE 0x6e, True)
  , (WRITE 0x6b, True)
  , (WRITE 0x6e, True)
  , (WRITE 0x6f, True)
  , (WRITE 0x77, True)
  , (WRITE 0x6e, True)
  , (WRITE 0x0d, True)
  , (WRITE 0x74, True)
  , (WRITE 0x65, True)
  , (WRITE 0x6c, True)
  , (WRITE 0x73, True)
  , (WRITE 0x74, True)
  , (WRITE 0x72, True)
  , (WRITE 0x61, True)
  , (WRITE 0x67, True)
  , (WRITE 0x6c, True)
  , (WRITE 0x6f, True)
  , (WRITE 0x62, True)
  , (WRITE 0x61, True)
  , (WRITE 0x6c, True)
  , (WRITE 0x03, True)
  , (WRITE 0x6e, True)
  , (WRITE 0x65, True)
  , (WRITE 0x74, True)
  , (WRITE 0x00, True)
  , (WRITE 0x00, False)
  ])

main :: IO ()
main = printX $ sampleN 13 $ topEntity testInput
